---
/**
 * Berita (Blog) Index Page - Level Garment
 *
 * Displays all blog posts in a card grid layout
 */
import PageLayout from '../../layouts/PageLayout.astro';
import BlogCard from '../../components/content/BlogCard.astro';
import blogPosts from '../../data/blog-posts.json';
import siteConfig from '../../data/site-config.json';

// Sort blog posts by date (newest first)
const sortedPosts = (blogPosts as any[]).sort((a, b) =>
  new Date(b.publishDate).getTime() - new Date(a.publishDate).getTime()
);

// Get unique categories
const categories = [...new Set(sortedPosts.map(post => post.category))];

// State for filtering (can be extended with JavaScript)
const currentCategory = 'all';
---

<PageLayout
  title="Berita - Level Garment"
  description="Baca artikel menarik seputar konveksi, jersey, jaket, dan tips seputar pemesanan baju custom."
  showHero={true}
  heroTitle="Berita & Artikel"
  heroSubtitle="Informasi menarik seputar konveksi dan tips pemesanan"
>
  <div class="berita-page">
    <!-- Blog Posts Grid -->
    <section class="blog-posts section">
      <div class="container">
        <!-- Category Filter (Optional - can be enabled with JS) -->
        {categories.length > 1 && (
          <div class="category-filter mb-8">
            <div class="flex flex-wrap gap-2 justify-center">
              <button
                class="category-btn active"
                data-category="all"
              >
                Semua
              </button>
              {categories.map(cat => (
                <button
                  class="category-btn"
                  data-category={cat}
                >
                  {cat}
                </button>
              ))}
            </div>
          </div>
        )}

        <!-- Blog Cards Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {sortedPosts.map(post => (
            <BlogCard
              title={post.title}
              slug={post.slug}
              excerpt={post.excerpt}
              publishDate={post.publishDate}
              category={post.category}
              image={post.image}
            />
          ))}
        </div>

        <!-- Post Count -->
        <div class="mt-12 text-center text-gray-500">
          <p>Menampilkan {sortedPosts.length} artikel</p>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="section bg-accent">
      <div class="container text-center">
        <h2 class="text-3xl font-bold text-gray-900 mb-4">
          Punya Pertanyaan?
        </h2>
        <p class="text-xl text-gray-800 mb-8">
          Hubungi kami untuk konsultasi gratis!
        </p>
        <a
          href={`${siteConfig.contact.whatsappUrl}?text=Hai%20kak!%20Ada%20yang%20ingin%20saya%20tanyakan%20tentang%20artikel%20di%20website%20Level%20Garment`}
          class="btn btn-secondary inline-flex"
        >
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
          </svg>
          Chat WhatsApp
        </a>
      </div>
    </section>
  </div>
</PageLayout>

<style>
  .category-filter {
    padding: 1rem;
    background: white;
    border-radius: 1rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  }

  .category-btn {
    padding: 0.5rem 1.25rem;
    border: 2px solid #e5e7eb;
    background: white;
    border-radius: 2rem;
    font-weight: 500;
    color: #6b7280;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .category-btn:hover {
    border-color: #1e40af;
    color: #1e40af;
  }

  .category-btn.active {
    background: #1e40af;
    border-color: #1e40af;
    color: white;
  }

  @media (max-width: 640px) {
    .category-filter {
      padding: 0.75rem;
    }

    .category-btn {
      padding: 0.375rem 0.875rem;
      font-size: 0.875rem;
    }
  }
</style>

<script>
  // Category filter functionality
  const categoryButtons = document.querySelectorAll('.category-btn');

  categoryButtons.forEach(button => {
    button.addEventListener('click', () => {
      const category = button.dataset.category;

      // Update active state
      categoryButtons.forEach(btn => btn.classList.remove('active'));
      button.classList.add('active');

      // Filter posts (this would require restructuring to work with static build)
      // For now, the buttons are visual - actual filtering would need client-side data
    });
  });
</script>
